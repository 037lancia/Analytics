
COMMENT
********************************************************************************
* Dit is het importscript gebaseerd op de XAF zoals opgesteld door SIVI
* waarmee deze voldoet aan de juiste naamgeven
* dit script dient als basis en importscripts voor anderen auditfiles dienen
* als output dezelfde veldnamen, types en lengtes te gebruiken.
* als een auditfile aan de XAF standaard voldoet, kan dit import script gebruikt
* worden.
*********************************************************************************

SET FOLDER /Tables/B0_Input

COM - IMPORT HEADER

IMPORT XML TO header "header.FIL" FROM "%v_InputFile%" FIELD "fiscalYear" C AT 1 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/header/fiscalYear/text()" FIELD "startDate" D AT 5 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/header/startDate/text()" FIELD "endDate" D AT 15 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/header/endDate/text()" FIELD "curCode" C AT 25 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/header/curCode/text()" FIELD "dateCreated" D AT 28 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/header/dateCreated/text()" FIELD "softwareDesc" C AT 38 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/header/softwareDesc/text()" FIELD "softwareVersion" C AT 78 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/header/softwareVersion/text()" 

COM - IMPORT COMPANY 

IMPORT XML TO company "company.fil" FROM "%v_InputFile%" FIELD "companyIdent" C AT 1 DEC 0 WID 19 PIC "" AS "" RULE "/auditfile/company/companyIdent/text()" FIELD "companyName" C AT 20 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/companyName/text()" FIELD "taxRegistrationCountry" C AT 120 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/taxRegistrationCountry/text()" FIELD "taxRegIdent" C AT 122 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/taxRegIdent/text()" FIELD "streetAddress_streetname" C AT 146 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/streetAddress/streetname/text()" FIELD "streetAddress_number" C AT 246 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/streetAddress/number/text()" FIELD "streetAddress_numberExtension" C AT 252 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/streetAddress/numberExtension/text()" FIELD "streetAddress_property" C AT 258 DEC 0 WID 42 PIC "" AS "" RULE "/auditfile/company/streetAddress/property/text()" FIELD "streetAddress_city" C AT 300 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/streetAddress/city/text()" FIELD "streetAddress_postalCode" C AT 400 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/streetAddress/postalCode/text()" FIELD "streetAddress_region" C AT 410 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/streetAddress/region/text()" FIELD "streetAddress_country" C AT 510 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/streetAddress/country/text()" FIELD "postalAddress_streetname" C AT 512 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/postalAddress/streetname/text()" FIELD "postalAddress_number" C AT 612 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/postalAddress/number/text()" FIELD "postalAddress_numberExtension" C AT 618 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/postalAddress/numberExtension/text()" FIELD "postalAddress_property" C AT 624 DEC 0 WID 42 PIC "" AS "" RULE "/auditfile/company/postalAddress/property/text()" FIELD "postalAddress_city" C AT 666 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/postalAddress/city/text()" FIELD "postalAddress_postalCode" C AT 766 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/postalAddress/postalCode/text()" FIELD "postalAddress_region" C AT 776 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/postalAddress/region/text()" FIELD "postalAddress_country" C AT 876 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/postalAddress/country/text()" 

COM - IMPORT customersSuppliers

IMPORT XML TO customersSuppliers "customersSuppliers.fil" FROM "%v_InputFile%" FIELD "custSupID" C AT 1 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/custSupID/text()" FIELD "custSupName" C AT 13 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/custSupName/text()" FIELD "contact" C AT 113 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/contact/text()" FIELD "telephone" C AT 213 DEC 0 WID 18 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/telephone/text()" FIELD "fax" C AT 231 DEC 0 WID 18 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/fax/text()" FIELD "eMail" C AT 249 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/eMail/text()" FIELD "website" C AT 349 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/website/text()" FIELD "commerceNr" C AT 399 DEC 0 WID 18 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/commerceNr/text()" FIELD "taxRegistrationCountry" C AT 417 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/taxRegistrationCountry/text()" FIELD "taxRegIdent" C AT 419 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/taxRegIdent/text()" FIELD "relationshipID" C AT 434 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/relationshipID/text()" FIELD "custSupTp" C AT 446 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/custSupTp/text()" FIELD "custSupGrpID" C AT 450 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/custSupGrpID/text()" FIELD "custCreditLimit" N AT 454 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/custCreditLimit/text()" FIELD "supplierLimit" N AT 468 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/supplierLimit/text()" FIELD "streetAddress_streetname" C AT 482 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/streetname/text()" FIELD "streetAddress_number" C AT 582 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/number/text()" FIELD "streetAddress_numberExtension" C AT 588 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/numberExtension/text()" FIELD "streetAddress_property" C AT 594 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/property/text()" FIELD "streetAddress_city" C AT 600 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/city/text()" FIELD "streetAddress_postalCode" C AT 650 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/postalCode/text()" FIELD "streetAddress_region" C AT 660 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/region/text()" FIELD "streetAddress_country" C AT 710 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/streetAddress/country/text()" FIELD "postalAddress_streetname" C AT 712 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/streetname/text()" FIELD "postalAddress_number" C AT 772 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/number/text()" FIELD "postalAddress_numberExtension" C AT 778 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/numberExtension/text()" FIELD "postalAddress_property" C AT 784 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/property/text()" FIELD "postalAddress_city" C AT 790 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/city/text()" FIELD "postalAddress_postalCode" C AT 840 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/postalCode/text()" FIELD "postalAddress_region" C AT 850 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/region/text()" FIELD "postalAddress_country" C AT 900 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/postalAddress/country/text()" FIELD "bankAccNr" C AT 902 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/bankAccount/bankAccNr/text()" FIELD "bankIdCd" C AT 926 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/bankAccount/bankIdCd/text()" FIELD "userID" C AT 950 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/changeInfo/userID/text()" FIELD "changeDateTime" C AT 1000 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/changeInfo/changeDateTime/text()" FIELD "changeDescription" C AT 1040 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/customersSuppliers/customerSupplier/changeInfo/changeDescription/text()" 

COM - IMPORT generalLedger
COM - let op, bij veldnamen is de prefix "ledgerAccount_" weg gelaten

IMPORT XML TO generalLedger "generalLedger.FIL" FROM "%v_InputFile%" FIELD "accID" C AT 1 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accID/text()" FIELD "accDesc" C AT 13 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accDesc/text()" FIELD "accTp" C AT 113 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accTp/text()" FIELD "leadCode" C AT 116 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/leadCode/text()" FIELD "leadDescription" C AT 140 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/leadDescription/text()" FIELD "leadReference" C AT 200 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/leadReference/text()" FIELD "leadCrossRef" C AT 224 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/leadCrossRef/text()" FIELD "taxoRef" C AT 248 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/taxonomy/taxoRef/text()" FIELD "entryPointRef" C AT 272 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/taxonomy/entryPoint/entryPointRef/text()" FIELD "conceptRef" C AT 372 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/taxonomy/entryPoint/conceptRef/text()" FIELD "domainMemberRef" C AT 472 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/taxonomy/entryPoint/domainMember/domainMemberRef/text()" FIELD "ledgerAccount_changeInfo_userID" C AT 572 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/changeInfo/userID/text()" FIELD "ledgerAccount_changeInfo_changeDateTime" C AT 672 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/changeInfo/changeDateTime/text()" FIELD "ledgerAccount_changeInfo_changeDescription" C AT 696 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/changeInfo/changeDescription/text()" 


COM IMPORT glAccountHistory Als aparte tabel omdat verondersteld wordt
COM dat dit veelal andere rekeningen zullen zijn dan in de tabel generalLedger

IMPORT XML TO glAccountHistory "glAccountHistory.fil" FROM "%v_InputFile%" FIELD "accID" C AT 1 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/accID/text()" FIELD "accDesc" C AT 13 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/accDesc/text()" FIELD "accTp" C AT 113 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/accTp/text()" FIELD "leadCode" C AT 116 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/leadCode/text()" FIELD "leadDescription" C AT 140 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/leadDescription/text()" FIELD "leadReference" C AT 200 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/leadReference/text()" FIELD "leadCrossRef" C AT 224 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/leadCrossRef/text()" FIELD "userID" C AT 248 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/changeInfo/userID/text()" FIELD "changeDateTime" C AT 298 DEC 0 WID 25 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/changeInfo/changeDateTime/text()" FIELD "changeDescription" C AT 323 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/glAccountHistory/glAccount/changeInfo/changeDescription/text()" 

COM IMPORT BASICS

IMPORT XML TO basics "basics.FIL" FROM "%v_InputFile%" FIELD "basicType" C AT 1 DEC 0 WID 9 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicType/text()" FIELD "basicID" C AT 10 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicID/text()" FIELD "basicDesc" C AT 50 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicDesc/text()" 

COM IMPORT VATCODES

IMPORT XML TO vatCodes "vatCodes.fil" FROM "%v_InputFile%" FIELD "vatID" C AT 1 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/vatCodes/vatCode/vatID/text()" FIELD "vatDesc" C AT 13 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/vatCodes/vatCode/vatDesc/text()" FIELD "vatToPayAccID" C AT 113 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/vatCodes/vatCode/vatToPayAccID/text()" FIELD "vatToClaimAccID" C AT 125 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/vatCodes/vatCode/vatToClaimAccID/text()" 

COM IMPORT PERIODS

IMPORT XML TO periods "periods.FIL" FROM "%v_InputFile%" FIELD "periodNumber" C AT 1 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/periods/period/periodNumber/text()" FIELD "periodDesc" C AT 5 DEC 0 WID 25 PIC "" AS "" RULE "/auditfile/company/periods/period/periodDesc/text()" FIELD "startDatePeriod" D AT 30 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/periods/period/startDatePeriod/text()" FIELD "startTimePeriod" C AT 40 DEC 0 WID 14 PIC "" AS "" RULE "/auditfile/company/periods/period/startTimePeriod/text()" FIELD "endDatePeriod" D AT 54 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/periods/period/endDatePeriod/text()" FIELD "endTimePeriod" C AT 64 DEC 0 WID 14 PIC "" AS "" RULE "/auditfile/company/periods/period/endTimePeriod/text()" 

COM IMPORT OPENINGBALANCES

IMPORT XML TO openingBalance "openingBalance.fil" FROM "%v_InputFile%" FIELD "opBalDate" D AT 1 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/openingBalance/opBalDate/text()" FIELD "opBalDesc" C AT 11 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/openingBalance/opBalDesc/text()" FIELD "linesCount" N AT 51 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/linesCount/text()" FIELD "totalDebit" N AT 63 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/totalDebit/text()" FIELD "totalCredit" N AT 77 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/totalCredit/text()" FIELD "nr" C AT 81 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obLine/nr/text()" FIELD "accID" C AT 93 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obLine/accID/text()" FIELD "amnt" N AT 105 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/obLine/amnt/text()" FIELD "amntTp" C AT 119 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/openingBalance/obLine/amntTp/text()" 

COM IMPORT OBSUBLEDGERS

IMPORT XML TO obSubledgers "obSubledgers.fil" FROM "%v_InputFile%" FIELD "sbType" C AT 1 DEC 0 WID 9 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/sbType/text()" FIELD "sbDesc" C AT 10 DEC 0 WID 90 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/sbDesc/text()" FIELD "linesCount" N AT 100 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/linesCount/text()" FIELD "totalDebit" N AT 112 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/totalDebit/text()" FIELD "totalCredit" N AT 126 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/totalCredit/text()" FIELD "nr" C AT 140 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/nr/text()" FIELD "obLineNr" C AT 152 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/obLineNr/text()" FIELD "desc" C AT 154 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/desc/text()" FIELD "amnt" N AT 214 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/amnt/text()" FIELD "amntTp" C AT 228 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/amntTp/text()" FIELD "docRef" C AT 229 DEC 0 WID 41 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/docRef/text()" FIELD "recRef" C AT 270 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/recRef/text()" FIELD "matchKeyID" C AT 310 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/matchKeyID/text()" FIELD "custSupID" C AT 350 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/custSupID/text()" FIELD "invRef" C AT 362 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/invRef/text()" FIELD "invPurSalTp" C AT 374 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/invPurSalTp/text()" FIELD "invTp" C AT 377 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/invTp/text()" FIELD "invDt" D AT 380 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/invDt/text()" FIELD "invDueDt" D AT 390 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/invDueDt/text()" FIELD "mutTp" C AT 400 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/mutTp/text()" FIELD "costID" C AT 410 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/costID/text()" FIELD "prodID" C AT 420 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/prodID/text()" FIELD "projID" C AT 430 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/projID/text()" FIELD "artGrpID" C AT 440 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/artGrpID/text()" FIELD "qntityID" C AT 450 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/qntityID/text()" FIELD "qntity" N AT 460 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/openingBalance/obSubledgers/obSubledger/obSbLine/qntity/text()" 

COM IMPORT TRANSACTIONS

IMPORT XML TO transactions "transactions.FIL" FROM "%v_InputFile%" FIELD "linesCount" N AT 1 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/linesCount/text()" FIELD "totalDebit" N AT 13 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/totalDebit/text()" FIELD "totalCredit" N AT 27 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/totalCredit/text()" FIELD "jrnID" C AT 10 DEC 41 WID 6 PIC "" AS "" RULE "/auditfile/company/transactions/journal/jrnID/text()" FIELD "journal_desc" C AT 47 DEC 0 WID 53 PIC "" AS "" RULE "/auditfile/company/transactions/journal/desc/text()" FIELD "jrnTp" C AT 100 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/jrnTp/text()" FIELD "offsetAccID" C AT 104 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/offsetAccID/text()" FIELD "journal_bankAccNr" C AT 116 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/transactions/journal/bankAccNr/text()" FIELD "transaction_nr" C AT 140 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/nr/text()" FIELD "transaction_desc" C AT 152 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/desc/text()" FIELD "periodNumber" C AT 212 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/periodNumber/text()" FIELD "trDt" D AT 215 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/journal/transaction/trDt/text()" FIELD "transaction_amnt" N AT 225 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/amnt/text()" FIELD "transaction_amntTp" C AT 229 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/amntTp/text()" FIELD "sourceID" C AT 230 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/sourceID/text()" FIELD "userID" C AT 254 DEC 0 WID 40 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/userID/text()" FIELD "trLine_nr" C AT 294 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/nr/text()" FIELD "accID" C AT 306 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/accID/text()" FIELD "docRef" C AT 318 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/docRef/text()" FIELD "effDate" D AT 342 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/effDate/text()" FIELD "trLine_desc" C AT 352 DEC 0 WID 100 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/desc/text()" FIELD "trLine_amnt" N AT 452 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/amnt/text()" FIELD "trLine_amntTp" C AT 466 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/amntTp/text()" FIELD "recRef" C AT 467 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/recRef/text()" FIELD "matchKeyID" C AT 487 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/matchKeyID/text()" FIELD "custSupID" C AT 507 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/custSupID/text()" FIELD "invRef" C AT 519 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/invRef/text()" FIELD "orderRef" C AT 539 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/orderRef/text()" FIELD "receivingDocRef" C AT 559 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/receivingDocRef/text()" FIELD "shipDocRef" C AT 579 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/shipDocRef/text()" FIELD "costID" C AT 599 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/costID/text()" FIELD "prodID" C AT 619 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/prodID/text()" FIELD "projID" C AT 639 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/projID/text()" FIELD "artGrpID" C AT 659 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/artGrpID/text()" FIELD "workCostArrRef" C AT 679 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/workCostArrRef/text()" FIELD "qntityID" C AT 699 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/qntityID/text()" FIELD "qntity" N AT 719 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/qntity/text()" FIELD "trLine_bankAccNr" C AT 731 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/bankAccNr/text()" FIELD "bankIdCd" C AT 755 DEC 0 WID 24 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/bankIdCd/text()" FIELD "vatID" C AT 779 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatID/text()" FIELD "vatPerc" N AT 791 DEC 0 WID 5 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatPerc/text()" FIELD "vatAmnt" N AT 796 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatAmnt/text()" FIELD "vatAmntTp" C AT 810 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatAmntTp/text()" FIELD "curCode" C AT 811 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/currency/curCode/text()" FIELD "curAmnt" N AT 814 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/currency/curAmnt/text()" 

COM IMPORT SUBLEDGERS

IMPORT XML TO subledgers "subledgers.fil" FROM "%v_InputFile%" FIELD "sbType" C AT 1 DEC 0 WID 9 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbType/text()" FIELD "sbDesc" C AT 10 DEC 0 WID 90 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbDesc/text()" FIELD "linesCount" N AT 100 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/linesCount/text()" FIELD "totalDebit" N AT 112 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/totalDebit/text()" FIELD "totalCredit" N AT 126 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/totalCredit/text()" FIELD "nr" C AT 140 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/nr/text()" FIELD "jrnID" C AT 152 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/jrnID/text()" FIELD "trNr" C AT 158 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/trNr/text()" FIELD "trLineNr" C AT 170 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/trLineNr/text()" FIELD "desc" C AT 182 DEC 0 WID 60 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/desc/text()" FIELD "amnt" N AT 242 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/amnt/text()" FIELD "amntTp" C AT 256 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/amntTp/text()" FIELD "docRef" C AT 257 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/docRef/text()" FIELD "recRef" C AT 277 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/recRef/text()" FIELD "matchKeyID" C AT 297 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/matchKeyID/text()" FIELD "custSupID" C AT 317 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/custSupID/text()" FIELD "invRef" C AT 329 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/invRef/text()" FIELD "invPurSalTp" C AT 349 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/invPurSalTp/text()" FIELD "invTp" C AT 352 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/invTp/text()" FIELD "invDt" D AT 355 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/invDt/text()" FIELD "invDueDt" D AT 365 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/invDueDt/text()" FIELD "mutTp" C AT 375 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/mutTp/text()" FIELD "costID" C AT 385 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/costID/text()" FIELD "prodID" C AT 405 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/prodID/text()" FIELD "projID" C AT 425 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/projID/text()" FIELD "artGrpID" C AT 445 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/artGrpID/text()" FIELD "qntityID" C AT 465 DEC 0 WID 20 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/qntityID/text()" FIELD "qntity" N AT 485 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/qntity/text()" FIELD "vatID" C AT 497 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/vat/vatID/text()" FIELD "vatPerc" N AT 509 DEC 2 WID 5 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/vat/vatPerc/text()" FIELD "vatAmnt" N AT 514 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/vat/vatAmnt/text()" FIELD "vatAmntTp" C AT 526 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/vat/vatAmntTp/text()" FIELD "curCode" C AT 527 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/currency/curCode/text()" FIELD "curAmnt" N AT 530 DEC 2 WID 14 PIC "" AS "" RULE "/auditfile/company/transactions/subledgers/subledger/sbLine/currency/curAmnt/text()" 
