SET SAFETY OFF
SET FOLDER /Tables
ASSIGN vNumber_XAF_done = vNumber_XAF_done + 1
OPEN XAF_list
LOCATE RECORD vNumber_XAF_done
ASSIGN vInput_file = ALLTRIM(File_Name)

COM het GeneralLedger import deel:
IMPORT XML TO GeneralLedger_temp "GeneralLedger_temp.fil" FROM ".\input\%vInput_file%" FIELD "fiscalYear" C AT 143 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/header/fiscalYear/text()" FIELD "accID" C AT 1 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accID/text()"FIELD "accDesc" C AT 5 DEC 0 WID 50 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accDesc/text()"FIELD "accTp" C AT 55 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/accTp/text()"FIELD "leadReference" C AT 56 DEC 0 WID 13 PIC "" AS "" RULE "/auditfile/company/generalLedger/ledgerAccount/leadReference/text()"FIELD "basicType" C AT 66 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicType/text()"FIELD "basicID" C AT 68 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicID/text()"FIELD "basicDesc" C AT 80 DEC 0 WID 54 PIC "" AS "" RULE "/auditfile/company/generalLedger/basics/basic/basicDesc/text()" OPEN
EXTRACT RECORD TO "GeneralLedger.fil" APPEND
DEL FORMAT GeneralLedger_temp OK
DEL GeneralLedger_temp.fil OK

COM het transactions import deel:
IMPORT XML TO transactions_temp "transactions_temp.fil" FROM ".\input\%vInput_file%" FIELD "fiscalYear" C AT 143 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/header/fiscalYear/text()" FIELD "linesCount" C AT 1 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/linesCount/text()" FIELD "totalDebit" C AT 4 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/transactions/totalDebit/text()" FIELD "totalCredit" C AT 14 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/transactions/totalCredit/text()" FIELD "jrnID" C AT 24 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/journal/jrnID/text()" FIELD "journal_desc" C AT 27 DEC 0 WID 26 PIC "" AS "" RULE "/auditfile/company/transactions/journal/desc/text()" FIELD "jrnTp" C AT 53 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/jrnTp/text()" FIELD "offsetAccID" C AT 54 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/offsetAccID/text()" FIELD "bankAccNr" C AT 58 DEC 0 WID 9 PIC "" AS "" RULE "/auditfile/company/transactions/journal/bankAccNr/text()" FIELD "transaction_nr" C AT 67 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/nr/text()" FIELD "transaction_desc" C AT 69 DEC 0 WID 30 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/desc/text()" FIELD "periodNumber" C AT 99 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/periodNumber/text()" FIELD "trDt" D AT 100 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/journal/transaction/trDt/text()" FIELD "transaction_amnt" C AT 110 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/amnt/text()" FIELD "transaction_amntTp" C AT 114 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/amntTp/text()" FIELD "trLine_nr" C AT 115 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/nr/text()" FIELD "accID" C AT 118 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/accID/text()" FIELD "docRef" C AT 122 DEC 0 WID 2 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/docRef/text()" FIELD "effDate" D AT 124 DEC 0 WID 10 PIC "YYYY-MM-DD" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/effDate/text()" FIELD "trLine_desc" C AT 134 DEC 0 WID 30 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/desc/text()" FIELD "trLine_amnt" C AT 164 DEC 0 WID 10 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/amnt/text()" FIELD "trLine_amntTp" C AT 174 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/amntTp/text()" FIELD "custSupID" C AT 175 DEC 0 WID 5 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/custSupID/text()" FIELD "invRef" C AT 180 DEC 0 WID 8 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/invRef/text()" FIELD "projID" C AT 188 DEC 0 WID 12 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/projID/text()" FIELD "prodID" C AT 200 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/prodID/text()" FIELD "costID" C AT 204 DEC 0 WID 4 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/costID/text()" FIELD "vatID" C AT 208 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatID/text()" FIELD "vatPerc" C AT 209 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatPerc/text()" FIELD "vatAmnt" C AT 215 DEC 0 WID 6 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatAmnt/text()" FIELD "vatAmntTp" C AT 221 DEC 0 WID 1 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/vat/vatAmntTp/text()" FIELD "curCode" C AT 222 DEC 0 WID 3 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/currency/curCode/text()" FIELD "curAmnt" C AT 225 DEC 0 WID 7 PIC "" AS "" RULE "/auditfile/company/transactions/journal/transaction/trLine/currency/curAmnt/text()" OPEN
EXTRACT RECORD TO "transactions.fil" APPEND
DEL FORMAT transactions_temp OK
DEL transactions_temp.fil OK
